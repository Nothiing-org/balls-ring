{
  "entities": {
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a video project with settings for revealing an image based on follower progress.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the project."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who created the project."
        },
        "name": {
          "type": "string",
          "description": "The name of the project."
        },
        "croppedImageUri": {
          "type": "string",
          "description": "Data URI of the cropped base image used in the project."
        },
        "revealMode": {
          "type": "string",
          "description": "The reveal mode (total followers or new followers)."
        },
        "pixelsPerFollower": {
          "type": "number",
          "description": "The number of pixels revealed per follower."
        },
        "maxPixelsCap": {
          "type": "number",
          "description": "The maximum number of pixels that can be revealed."
        },
        "randomSeed": {
          "type": "number",
          "description": "The random seed used for pixel reveal."
        },
        "createdAt": {
          "type": "string",
          "description": "The date and time the project was created.",
          "format": "date-time"
        },
        "days": {
          "type": "array",
          "description": "A list of daily updates for the project.",
          "items": {
            "$ref": "#/entities/DailyUpdate"
          }
        }
      },
      "required": [
        "id",
        "userId",
        "name",
        "croppedImageUri",
        "revealMode",
        "pixelsPerFollower",
        "maxPixelsCap",
        "randomSeed",
        "createdAt",
        "days"
      ]
    },
    "DailyUpdate": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DailyUpdate",
      "type": "object",
      "description": "Represents a daily update for a project, including follower count and pixels revealed. This is embedded in the Project document.",
      "properties": {
        "dayIndex": {
          "type": "number",
          "description": "The day number of the update."
        },
        "followerCount": {
          "type": "number",
          "description": "The follower count for the day."
        },
        "pixelsRevealed": {
          "type": "number",
          "description": "The number of pixels revealed on this day."
        },
        "frameDataUri": {
          "type": "string",
          "description": "Data URI of the generated video frame for this day."
        },
        "createdAt": {
          "type": "string",
          "description": "The date and time this update was generated.",
          "format": "date-time"
        }
      },
      "required": [
        "dayIndex",
        "followerCount",
        "pixelsRevealed",
        "createdAt"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user (could be null for anonymous users).",
          "format": "email"
        },
        "createdAt": {
          "type": "string",
          "description": "The date and time the user was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "createdAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/entities/User"
          },
          "description": "Stores user profiles. Path-based ownership ensures only the user can access their profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/projects/{projectId}",
        "definition": {
          "entityName": "Project",
          "schema": {
            "$ref": "#/entities/Project"
          },
          "description": "Stores video projects created by the user. Includes denormalized 'userId' for authorization independence.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "projectId",
              "description": "The unique identifier for the project."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure authorization independence and scalability. User data is private. Projects are stored as a subcollection under the user who owns them. Daily updates are embedded within the project document as an array since they are always read with the project and this simplifies data retrieval for the client. Anonymous authentication is enabled to allow users to use the app without creating an account."
  }
}
